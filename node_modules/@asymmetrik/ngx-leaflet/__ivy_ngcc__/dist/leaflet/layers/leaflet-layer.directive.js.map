{"version":3,"file":"leaflet-layer.directive.js","sources":["../../../src/leaflet/layers/leaflet-layer.directive.ts"],"names":[],"mappings":";;;;;;;;;;AAAA,OAAO,EACN,SAAS,EAAE,YAAY,EAAE,KAAK,EAAE,MAAM,EAAgC,MAAM,EAE5E,MAAM,eAAe,CAAC;AAEvB,OAAO,EAAC,KAAK,EAAgB,MAAM,SAAS,CAAC;AAE7C,OAAO,EAAE,gBAAgB,EAAE,MAAM,2BAA2B,CAAC;AAC7D,OAAO,EAAE,uBAAuB,EAAE,MAAM,mCAAmC,CAAC;AAC5E,OAAO,EAAE,WAAW,EAAE,MAAM,sBAAsB,CAAC;AAGnD;;;;;;GAMG;AAIH;IAYC,+BAAY,gBAAkC,EAAU,IAAY;QAAZ,SAAI,GAAJ,IAAI,CAAQ;QAPpE,eAAe;QACY,UAAK,GAAG,IAAI,YAAY,EAAgB,CAAC;QACtC,aAAQ,GAAG,IAAI,YAAY,EAAgB,CAAC;QAMzE,IAAI,CAAC,gBAAgB,GAAG,IAAI,uBAAuB,CAAC,gBAAgB,CAAC,CAAC;IACvE,CAAC;IAED,wCAAQ,GAAR;QAEC,eAAe;QACf,IAAI,CAAC,gBAAgB,CAAC,IAAI,EAAE,CAAC;IAE9B,CAAC;IAED,2CAAW,GAAX;QACC,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC;IACrB,CAAC;IAED,2CAAW,GAAX,UAAY,OAAwC;QAApD,iBAoBC;QAlBA,IAAI,OAAO,CAAC,OAAO,CAAC,EAAE;YAErB,mBAAmB;YACnB,IAAM,GAAC,GAAU,OAAO,CAAC,OAAO,CAAC,CAAC,aAAa,CAAC;YAChD,IAAM,GAAC,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC,YAAY,CAAC;YAExC,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC;gBAC3B,IAAI,IAAI,IAAI,GAAC,EAAE;oBACd,GAAC,CAAC,MAAM,EAAE,CAAC;iBACX;gBACD,IAAI,IAAI,IAAI,GAAC,EAAE;oBACd,KAAI,CAAC,sBAAsB,CAAC,GAAC,CAAC,CAAC;oBAC/B,KAAI,CAAC,gBAAgB,CAAC,MAAM,EAAE,CAAC,QAAQ,CAAC,GAAC,CAAC,CAAC;iBAC3C;YACF,CAAC,CAAC,CAAC;SAEH;IAEF,CAAC;IAEO,sDAAsB,GAA9B,UAA+B,CAAQ;QAAvC,iBAKC;QAHA,CAAC,CAAC,EAAE,CAAC,KAAK,EAAE,UAAC,CAAe,IAAK,OAAA,WAAW,CAAC,WAAW,CAAC,KAAI,CAAC,IAAI,EAAE,KAAI,CAAC,KAAK,EAAE,CAAC,CAAC,EAAjD,CAAiD,CAAC,CAAC;QACpF,CAAC,CAAC,EAAE,CAAC,QAAQ,EAAE,UAAC,CAAe,IAAK,OAAA,WAAW,CAAC,WAAW,CAAC,KAAI,CAAC,IAAI,EAAE,KAAI,CAAC,QAAQ,EAAE,CAAC,CAAC,EAApD,CAAoD,CAAC,CAAC;IAE3F,CAAC;IAnDsB;QAAtB,KAAK,CAAC,cAAc,CAAC;kCAAQ,KAAK;wDAAC;IAGT;QAA1B,MAAM,CAAC,iBAAiB,CAAC;;wDAA0C;IACtC;QAA7B,MAAM,CAAC,oBAAoB,CAAC;;2DAA6C;IAP9D,qBAAqB,eACpB,SAJb,SAAS,CAAC,cACV,QAAQ,EAAE,gBAAgB,3DAEnB,kCAYuB,gBAAgB,EAAgB,MAAM;QAbpE,CAAC,FACW,qBAAqB,CAwDjC;;;;;;;;;;;;;;;;;oBACD;IADA,4BAAC;CAAA,AAxDD,IAwDC;SAxDY,qBAAqB","sourcesContent":["import {\n\tDirective, EventEmitter, Input, NgZone, OnChanges, OnDestroy, OnInit, Output,\n\tSimpleChange\n} from '@angular/core';\n\nimport {Layer, LeafletEvent } from 'leaflet';\n\nimport { LeafletDirective } from '../core/leaflet.directive';\nimport { LeafletDirectiveWrapper } from '../core/leaflet.directive.wrapper';\nimport { LeafletUtil } from '../core/leaflet.util';\n\n\n/**\n * Layer directive\n *\n * This directive is used to directly control a single map layer. The purpose of this directive is to\n * be used as part of a child structural directive of the map element.\n *\n */\n@Directive({\n\tselector: '[leafletLayer]'\n})\nexport class LeafletLayerDirective\n\timplements OnChanges, OnDestroy, OnInit {\n\n\t@Input('leafletLayer') layer: Layer;\n\n\t// Layer Events\n\t@Output('leafletLayerAdd') onAdd = new EventEmitter<LeafletEvent>();\n\t@Output('leafletLayerRemove') onRemove = new EventEmitter<LeafletEvent>();\n\n\t// Wrapper for the leaflet directive (manages the parent directive)\n\tprivate leafletDirective: LeafletDirectiveWrapper;\n\n\tconstructor(leafletDirective: LeafletDirective, private zone: NgZone) {\n\t\tthis.leafletDirective = new LeafletDirectiveWrapper(leafletDirective);\n\t}\n\n\tngOnInit() {\n\n\t\t// Init the map\n\t\tthis.leafletDirective.init();\n\n\t}\n\n\tngOnDestroy() {\n\t\tthis.layer.remove();\n\t}\n\n\tngOnChanges(changes: { [key: string]: SimpleChange }) {\n\n\t\tif (changes['layer']) {\n\n\t\t\t// Update the layer\n\t\t\tconst p: Layer = changes['layer'].previousValue;\n\t\t\tconst n = changes['layer'].currentValue;\n\n\t\t\tthis.zone.runOutsideAngular(() => {\n\t\t\t\tif (null != p) {\n\t\t\t\t\tp.remove();\n\t\t\t\t}\n\t\t\t\tif (null != n) {\n\t\t\t\t\tthis.addLayerEventListeners(n);\n\t\t\t\t\tthis.leafletDirective.getMap().addLayer(n);\n\t\t\t\t}\n\t\t\t});\n\n\t\t}\n\n\t}\n\n\tprivate addLayerEventListeners(l: Layer) {\n\n\t\tl.on('add', (e: LeafletEvent) => LeafletUtil.handleEvent(this.zone, this.onAdd, e));\n\t\tl.on('remove', (e: LeafletEvent) => LeafletUtil.handleEvent(this.zone, this.onRemove, e));\n\n\t}\n\n}\n"]}