import { __extends } from "tslib";
import { AutoPositionStrategy } from '../../../services/overlay/position/auto-position-strategy';
/** @hidden */
var ExcelStylePositionStrategy = /** @class */ (function (_super) {
    __extends(ExcelStylePositionStrategy, _super);
    function ExcelStylePositionStrategy() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    ExcelStylePositionStrategy.prototype.shouldFitInViewPort = function (connectedFit) {
        return true;
    };
    ExcelStylePositionStrategy.prototype.fitInViewport = function (element, connectedFit) {
        var heightOverflow = connectedFit.contentElementRect.height - connectedFit.viewPortRect.height;
        if (heightOverflow > 0) {
            element.style.width = 'auto';
            element.style.height = connectedFit.viewPortRect.height + "px";
        }
        else {
            element.style.height = Math.max(connectedFit.viewPortRect.height - connectedFit.targetRect.bottom - 1, connectedFit.contentElementRect.height) + "px";
        }
        _super.prototype.fitInViewport.call(this, element, connectedFit);
    };
    return ExcelStylePositionStrategy;
}(AutoPositionStrategy));
export { ExcelStylePositionStrategy };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXhjZWwtc3R5bGUtcG9zaXRpb24tc3RyYXRlZ3kuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9pZ25pdGV1aS1hbmd1bGFyLyIsInNvdXJjZXMiOlsibGliL2dyaWRzL2ZpbHRlcmluZy9leGNlbC1zdHlsZS9leGNlbC1zdHlsZS1wb3NpdGlvbi1zdHJhdGVneS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFFLG9CQUFvQixFQUFFLE1BQU0sMkRBQTJELENBQUM7QUFHakcsY0FBYztBQUNkO0lBQWdELDhDQUFvQjtJQUFwRTs7SUFrQkEsQ0FBQztJQWpCYSx3REFBbUIsR0FBN0IsVUFBOEIsWUFBMEI7UUFDcEQsT0FBTyxJQUFJLENBQUM7SUFDaEIsQ0FBQztJQUVTLGtEQUFhLEdBQXZCLFVBQXdCLE9BQW9CLEVBQUUsWUFBMEI7UUFDcEUsSUFBTSxjQUFjLEdBQUcsWUFBWSxDQUFDLGtCQUFrQixDQUFDLE1BQU0sR0FBRyxZQUFZLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQztRQUNqRyxJQUFJLGNBQWMsR0FBRyxDQUFDLEVBQUU7WUFDcEIsT0FBTyxDQUFDLEtBQUssQ0FBQyxLQUFLLEdBQUcsTUFBTSxDQUFDO1lBQzdCLE9BQU8sQ0FBQyxLQUFLLENBQUMsTUFBTSxHQUFNLFlBQVksQ0FBQyxZQUFZLENBQUMsTUFBTSxPQUFJLENBQUM7U0FDbEU7YUFBTTtZQUNILE9BQU8sQ0FBQyxLQUFLLENBQUMsTUFBTSxHQUFNLElBQUksQ0FBQyxHQUFHLENBQzlCLFlBQVksQ0FBQyxZQUFZLENBQUMsTUFBTSxHQUFHLFlBQVksQ0FBQyxVQUFVLENBQUMsTUFBTSxHQUFHLENBQUMsRUFDckUsWUFBWSxDQUFDLGtCQUFrQixDQUFDLE1BQU0sQ0FBQyxPQUFJLENBQUM7U0FDbkQ7UUFFRCxpQkFBTSxhQUFhLFlBQUMsT0FBTyxFQUFFLFlBQVksQ0FBQyxDQUFDO0lBQy9DLENBQUM7SUFDTCxpQ0FBQztBQUFELENBQUMsQUFsQkQsQ0FBZ0Qsb0JBQW9CLEdBa0JuRSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEF1dG9Qb3NpdGlvblN0cmF0ZWd5IH0gZnJvbSAnLi4vLi4vLi4vc2VydmljZXMvb3ZlcmxheS9wb3NpdGlvbi9hdXRvLXBvc2l0aW9uLXN0cmF0ZWd5JztcbmltcG9ydCB7IENvbm5lY3RlZEZpdCB9IGZyb20gJy4uLy4uLy4uL3NlcnZpY2VzL292ZXJsYXkvdXRpbGl0aWVzJztcblxuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCBjbGFzcyBFeGNlbFN0eWxlUG9zaXRpb25TdHJhdGVneSBleHRlbmRzIEF1dG9Qb3NpdGlvblN0cmF0ZWd5IHtcbiAgICBwcm90ZWN0ZWQgc2hvdWxkRml0SW5WaWV3UG9ydChjb25uZWN0ZWRGaXQ6IENvbm5lY3RlZEZpdCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgZml0SW5WaWV3cG9ydChlbGVtZW50OiBIVE1MRWxlbWVudCwgY29ubmVjdGVkRml0OiBDb25uZWN0ZWRGaXQpIHtcbiAgICAgICAgY29uc3QgaGVpZ2h0T3ZlcmZsb3cgPSBjb25uZWN0ZWRGaXQuY29udGVudEVsZW1lbnRSZWN0LmhlaWdodCAtIGNvbm5lY3RlZEZpdC52aWV3UG9ydFJlY3QuaGVpZ2h0O1xuICAgICAgICBpZiAoaGVpZ2h0T3ZlcmZsb3cgPiAwKSB7XG4gICAgICAgICAgICBlbGVtZW50LnN0eWxlLndpZHRoID0gJ2F1dG8nO1xuICAgICAgICAgICAgZWxlbWVudC5zdHlsZS5oZWlnaHQgPSBgJHtjb25uZWN0ZWRGaXQudmlld1BvcnRSZWN0LmhlaWdodH1weGA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBlbGVtZW50LnN0eWxlLmhlaWdodCA9IGAke01hdGgubWF4KFxuICAgICAgICAgICAgICAgIGNvbm5lY3RlZEZpdC52aWV3UG9ydFJlY3QuaGVpZ2h0IC0gY29ubmVjdGVkRml0LnRhcmdldFJlY3QuYm90dG9tIC0gMSxcbiAgICAgICAgICAgICAgICBjb25uZWN0ZWRGaXQuY29udGVudEVsZW1lbnRSZWN0LmhlaWdodCl9cHhgO1xuICAgICAgICB9XG5cbiAgICAgICAgc3VwZXIuZml0SW5WaWV3cG9ydChlbGVtZW50LCBjb25uZWN0ZWRGaXQpO1xuICAgIH1cbn1cbiJdfQ==